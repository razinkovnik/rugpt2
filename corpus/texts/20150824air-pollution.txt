
Ученые из Рочестерского университета создали алгоритм для определения концентрации атмосферной пыли по любительским фотографиям. Программа использует сверточные нейронные сети и стандартные методы цветокоррекции для вычисления уровня дымки на изображении, который ученые предполагают переводить его напрямую в концентрацию пыли. Препринт выложен на arXiv.org.Авторы опирались на ставший уже традиционным алгоритм «очищения» фотографий от дымки. Для этого изображение переводят в «темный канал» (dark channel): каждому пикселю приписывают интенсивность самого слабого из его RGB-составляющих. Например, если пиксель ярко-желтый, то его красная (R) и зеленая (G) составляющие будут интенсивными, а синяя (B) — нет. Поэтому «темная составляющая» для данного пикселя будет очень слабой, практически черной. Если же данный пиксель относится к участку снимка, покрытого дымкой, он, вероятнее всего, будет близок к одному из оттенков серого. Его RGB составляющие будут примерно равны по интенсивности, и среди них не будет явного «отстающего». Такой пиксель в «темном канале» также останется серым. В итоге получается, что на «темном канале» данного снимка ярко выделяются только те места, которые покрыты дымкой. Из распределения дымки ученые получали матрицу пропускания (transmission matrix), на которой выделяются участки с различной степенью рассеивания света. При помощи другого метода — набора обученных заранее сверточных нейросетей — авторы получали карту глубины, то есть распределение объектов на снимке по удаленности от фотографа. Окончательным этапом работы было выделение общего уровня «задымленности» воздуха на снимке. В теории принимается, что пропускание (T — transmission) и глубина (D — depth) связаны между собой экспоненциально: T = e-K*D. В этой формуле K — искомый уровень «задымленности», который должен быть одинаковым для всех пикселей. Из-за неизбежного наличия погрешностей при обработке этот уровень все же варьировался для разных участков фотографии, поэтому ученые разработали специальный алгоритм для корректного усреднения.
